<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Detective de Algoritmos - Pizarra de L칩gica</title>
    <style>
        /* Estilo: Pizarra de Clase */
        body {
            font-family: 'Chalkduster', 'Permanent Marker', cursive, sans-serif;
            background-color: #215e21; /* Verde Oscuro/Pizarra */
            color: #ffffff; /* Texto Blanco/Tiza */
            padding: 20px;
            margin: 0;
            line-height: 1.6;
        }

        h1 {
            text-align: center;
            border-bottom: 2px solid #fff;
            padding-bottom: 10px;
            text-shadow: 2px 2px #000;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            margin-bottom: 20px;
            box-sizing: border-box;
            background-color: #1a4d1a;
            color: #ffffff;
            border: 1px solid #ffffff;
            resize: vertical;
            font-size: 1.1em;
        }

        button {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #e0ac4c; /* Amarillo/Naranja de Tiza */
            color: #000000;
            border: none;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #f7d37e;
        }

        /* 츼rea de Salida Educativa */
        #output {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px dashed #ffffff;
        }

        .phase-title {
            color: #8aff8a; /* Verde Brillante para t칤tulos de fase */
            font-size: 1.4em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        /* Estilo de la tabla (Prueba de Escritorio) */
        .desktop-test-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .desktop-test-table th, .desktop-test-table td {
            border: 1px solid #ffffff;
            padding: 10px;
            text-align: center;
        }

        .desktop-test-table th {
            background-color: #3b8b3b;
            font-weight: bold;
        }

        /* Estilo para simular el resaltado del paso actual */
        .highlight-row {
            background-color: #4baf4b !important;
            color: #ffff00; /* Tiza amarilla */
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>游댌 El Detective de Algoritmos</h1>

        <p>**Instrucciones:** Ingresa un problema l칩gico. Pru칠balo con: **'Calcular el factorial de 5'** o **'Sumar pares hasta 10'**.</p>

        <textarea id="problemInput" placeholder="Ejemplo: 'Calcular el factorial de 5' o 'Sumar los n칰meros pares hasta 10.'"></textarea>

        <button onclick="analyzeProblem()">Analizar paso a paso</button>

        <div id="output">
            </div>
    </div>

    <script>
        function analyzeProblem() {
            const problem = document.getElementById('problemInput').value.trim().toLowerCase();
            const output = document.getElementById('output');
            output.innerHTML = ''; // Limpiar salida anterior

            if (problem === "") {
                output.innerHTML = '<p style="color: red;">Por favor, ingresa un problema para analizar.</p>';
                return;
            }

            // Objeto base para el an치lisis
            let analysis = {
                variables: "N/L칤mite (Entrada), Acumulador, Contador",
                input: "Un n칰mero entero positivo",
                output: "El resultado del c치lculo",
                pseudocode: "No reconocido. Intenta con 'factorial' o 'sumar pares'.",
                testData: [
                    ["Paso", "Variables...", "Resultado", "Comentario"],
                    ["Error", "Revisa el enunciado", "-", "El motor de an치lisis solo simula Factorial o Suma de Pares."]
                ]
            };

            // Intentar extraer un n칰mero del enunciado
            const numMatch = problem.match(/\d+/);
            const N = numMatch ? parseInt(numMatch[0]) : null;

            // --- L칍GICA DE C츼LCULO REAL: FACTORIAL ---
            if (problem.includes('factorial')) {
                const targetN = N !== null ? N : 5; // Usar 5 si no se especifica un n칰mero
                let factorial = 1;
                let testData = [
                    ["Paso", "i", "Factorial", "N", "Comentario"],
                    ["Inicio", "-", "1", targetN, "Inicializaci칩n"]
                ];

                for (let i = 1; i <= targetN; i++) {
                    const prevFactorial = factorial;
                    factorial *= i; // **춰C치lculo real!**
                    testData.push([`Iteraci칩n ${i}`, i, factorial, targetN, `${prevFactorial} * ${i}`]);
                }

                testData.push([`Fin`, `${targetN + 1} (Sale)`, factorial, targetN, "Bucle terminado. Resultado final."]);

                analysis = {
                    variables: "N (Entrada), Factorial (Acumulador), i (Contador)",
                    input: `El n칰mero ${targetN}`,
                    output: `El factorial es ${factorial}`,
                    pseudocode: "INICIO\n  LEER N\n  Factorial <- 1\n  Para i <- 1 Hasta N Hacer\n    Factorial <- Factorial * i\n  Fin Para\n  ESCRIBIR Factorial\nFIN",
                    testData: testData
                };
            } 
            
            // --- L칍GICA DE C츼LCULO REAL: SUMA DE PARES ---
            else if (problem.includes('sumar') && problem.includes('pares')) {
                const limit = N !== null ? N : 10; // Usar 10 si no se especifica
                let sum = 0;
                let testData = [
                    ["Paso", "i", "Suma", "L칤mite", "Comentario"],
                    ["Inicio", "0", "0", limit, "Inicializaci칩n"]
                ];
                let iter = 1;

                for (let i = 2; i <= limit; i += 2) {
                    const prevSum = sum;
                    sum += i; // **춰C치lculo real!**
                    testData.push([`Iteraci칩n ${iter}`, i, sum, limit, `${prevSum} + ${i}`]);
                    iter++;
                }

                testData.push([`Fin`, `${limit + 2} (Sale)`, sum, limit, "Bucle terminado. Resultado final."]);

                analysis = {
                    variables: "L칤mite (Entrada), Suma (Acumulador), i (Contador)",
                    input: `El n칰mero l칤mite: ${limit}`,
                    output: `La suma de pares es ${sum}`,
                    pseudocode: "INICIO\n  LEER L칤mite\n  Suma <- 0\n  Para i <- 2 Hasta L칤mite Con Paso 2 Hacer\n    Suma <- Suma + i\n  Fin Para\n  ESCRIBIR Suma\nFIN",
                    testData: testData
                };
            }

            // -----------------------------------------------------

            // --- FASE 1: An치lisis ---
            output.innerHTML += '<div class="phase-title">Fase 1: An치lisis 游</div>';
            output.innerHTML += `
                <p><strong>Variables Necesarias:</strong> ${analysis.variables}</p>
                <p><strong>Entrada:</strong> ${analysis.input}</p>
                <p><strong>Salida Esperada:</strong> ${analysis.output}</p>
            `;

            // --- FASE 2: Pseudoc칩digo ---
            output.innerHTML += '<div class="phase-title">Fase 2: Pseudoc칩digo 游닇</div>';
            output.innerHTML += `<pre style="background-color: rgba(0, 0, 0, 0.4); padding: 15px; border: 1px dashed #ffffff;">${analysis.pseudocode}</pre>`;

            // --- FASE 3: Prueba de Escritorio ---
            output.innerHTML += '<div class="phase-title">Fase 3: Prueba de Escritorio (춰Paso a Paso!) 游녺</div>';
            output.innerHTML += createDesktopTestTable(analysis.testData);
            
            animateDesktopTest();
        }

        // Funci칩n para generar la tabla HTML
        function createDesktopTestTable(data) {
            let html = '<table class="desktop-test-table" id="desktopTestTable">';
            
            // Encabezados
            html += '<thead><tr>';
            data[0].forEach(header => {
                html += `<th>${header}</th>`;
            });
            html += '</tr></thead>';

            // Filas de Datos
            html += '<tbody>';
            for (let i = 1; i < data.length; i++) {
                html += `<tr>`;
                data[i].forEach(cell => {
                    html += `<td>${cell}</td>`;
                });
                html += '</tr>';
            }
            html += '</tbody></table>';
            return html;
        }

        // Funci칩n para animar el paso a paso
        function animateDesktopTest() {
            const table = document.getElementById('desktopTestTable');
            if (!table) return;

            const rows = table.querySelectorAll('tbody tr');
            let delay = 0;
            rows.forEach((row, index) => {
                // Aumentar el retraso para que parezca paso a paso
                delay += 700; 
                setTimeout(() => {
                    // Des-resaltar la fila anterior (si no es la primera)
                    if (index > 0) {
                        rows[index - 1].classList.remove('highlight-row');
                    }
                    // Resaltar la fila actual
                    row.classList.add('highlight-row');
                }, delay);
            });
            
            // Des-resaltar la 칰ltima fila al final
            setTimeout(() => {
                if (rows.length > 0) {
                     rows[rows.length - 1].classList.remove('highlight-row');
                }
            }, delay + 700);
        }

    </script>
</body>
</html>